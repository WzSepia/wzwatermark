!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.wzwatermark=t():e.wzwatermark=t()}(this,(()=>(()=>{"use strict";var e={d:(t,r)=>{for(var o in r)e.o(r,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:r[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=c(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,c(o.key),o)}}function c(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}e.r(t),e.d(t,{default:()=>y,initWatermark:()=>u,removeWatermark:()=>f});var s=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.watermarkId="global-watermark",this.observer=null},t=[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.remove(),this.options=n(n({},{content:"请勿外传",font:"Arial, sans-serif",size:16,color:"#000",opacity:.15,angle:-15,density:2}),e),this.createWatermark(),this.observeDOMChanges()}},{key:"createWatermark",value:function(){var e=this.options,t=e.content,r=e.font,o=e.size,n=e.color,i=e.opacity,a=e.angle,c=e.density,s=document.createElement("div");s.id=this.watermarkId,s.style.pointerEvents="none",s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.overflow="hidden",s.style.zIndex="9999";var l=document.createElement("canvas"),u=l.getContext("2d"),f=u.measureText(t).width,y=o,b=Math.PI/180*Math.abs(a),d=f*Math.cos(b)+y*Math.sin(b),p=f*Math.sin(b)+y*Math.cos(b);l.width=d*c,l.height=p*c,u.font="".concat(o,"px ").concat(r),u.fillStyle=n,u.globalAlpha=i,u.textAlign="center",u.textBaseline="middle",u.translate(l.width/2,l.height/2),u.rotate(Math.PI/180*a),u.fillText(t,0,0);var m=l.toDataURL();s.style.backgroundImage="url(".concat(m,")"),s.style.backgroundRepeat="repeat",s.style.backgroundSize="".concat(l.width,"px ").concat(l.height,"px"),document.body.appendChild(s)}},{key:"remove",value:function(){var e=document.getElementById(this.watermarkId);e&&document.body.removeChild(e),this.stopObserving()}},{key:"observeDOMChanges",value:function(){var e=this;this.stopObserving(),this.observer=new MutationObserver((function(t){t.forEach((function(t){if(t.removedNodes.length)for(var r=0;r<t.removedNodes.length;r++)if(t.removedNodes[r].id===e.watermarkId){setTimeout((function(){return e.createWatermark()}),0);break}}))})),this.observer.observe(document.body,{childList:!0,subtree:!0})}},{key:"stopObserving",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null)}}],t&&a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();const l=new s;function u(e){l.init(e)}function f(){l.remove()}const y={install:function(e,t){u(t),e.mixin({beforeCreate:function(){document.getElementById(l.watermarkId)||u(t)}})}};return t})()));